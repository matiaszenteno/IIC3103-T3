{"ast":null,"code":"import _defineProperty from\"/Users/matiaszenteno/app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/matiaszenteno/app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/matiaszenteno/app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/matiaszenteno/app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/matiaszenteno/app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/matiaszenteno/app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/matiaszenteno/app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/matiaszenteno/app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import ReactDOM from'react-dom';import io from\"socket.io-client\";import'./index.css';import Leaflet from'leaflet';import{MapContainer,TileLayer,Marker,Popup,Polyline}from'react-leaflet';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";delete Leaflet.Icon.Default.prototype._getIconUrl;Leaflet.Icon.Default.mergeOptions({className:'icon'});var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.setCurrentNickname=function(nickname){_this.setState({current_nickname:nickname});};_this.setNickname=function(){_this.setState({nickname:_this.state.current_nickname});};_this.setCurrentMessage=function(message){_this.setState({current_message:message});};_this.sendMessage=function(){if(_this.state.nickname){var body=_this.state.current_message;var message={name:_this.state.nickname,message:body};_this.socket.emit('CHAT',message);}};_this.state={nickname:'',current_nickname:'',current_message:'',messages:[],flights:[],positions:{},paths:{}};_this.setCurrentNickname=_this.setCurrentNickname.bind(_assertThisInitialized(_this));_this.setNickname=_this.setNickname.bind(_assertThisInitialized(_this));_this.setCurrentMessage=_this.setCurrentMessage.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.socket=io.connect('wss://tarea-3-websocket.2021-1.tallerdeintegracion.cl',{path:'/flights/',transports:['websocket']});this.socket.on('CHAT',function(message){_this2.setState({messages:[].concat(_toConsumableArray(_this2.state.messages),[message])});});this.socket.on('FLIGHTS',function(flights){_this2.setState({flights:flights});});this.socket.on('POSITION',function(position){_this2.setState(function(prevState){return{positions:_objectSpread(_objectSpread({},prevState.positions),{},_defineProperty({},position.code,position.position))};});_this2.socket.emit('FLIGHTS',{});});}},{key:\"render\",value:function render(){var _this3=this;var messages=this.state.messages.map(function(message,index){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"b\",{children:[message.name,\": \",message.message]})},index);});var flights=this.state.flights.map(function(flight,index){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flight-info\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"flight-info-line\",children:/*#__PURE__*/_jsxs(\"b\",{children:[\"VUELO \",flight['code']]})}),/*#__PURE__*/_jsxs(\"p\",{className:\"flight-info-line\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Aerol\\xEDnea:\"}),\" \",flight['airline']]}),/*#__PURE__*/_jsxs(\"p\",{className:\"flight-info-line\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Origen:\"}),\" \",flight['origin']]}),/*#__PURE__*/_jsxs(\"p\",{className:\"flight-info-line\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Destino:\"}),\" \",flight['destination']]}),/*#__PURE__*/_jsxs(\"p\",{className:\"flight-info-line\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Avi\\xF3n:\"}),\" \",flight['plane']]}),/*#__PURE__*/_jsxs(\"p\",{className:\"flight-info-line\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Asientos:\"}),\" \",flight['seats']]}),/*#__PURE__*/_jsx(\"p\",{className:\"flight-info-line\",children:/*#__PURE__*/_jsx(\"b\",{children:\"Pasajeros:\"})}),flight['passengers'].map(function(passenger,key){return/*#__PURE__*/_jsxs(\"p\",{children:[passenger.name,\", \",passenger.age,\" a\\xF1os.\"]},key);})]})},index);});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-container\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Informaci\\xF3n Vuelos\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"general-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"base-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"map-container\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(MapContainer,{className:\"map\",zoom:5,center:[-30,-70],children:[/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"}),Object.keys(this.state.positions).map(function(key,index){return/*#__PURE__*/_jsx(Marker,{position:_this3.state.positions[key],children:/*#__PURE__*/_jsx(Popup,{children:key})},key);})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Centro de Control\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"nickname-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Ingresa tu nombre\",onChange:function onChange(e){return _this3.setCurrentNickname(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return _this3.setNickname();},children:\"Ingresar\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"messages-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"messages-input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Ingresa tu mensaje\",onChange:function onChange(e){return _this3.setCurrentMessage(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return _this3.sendMessage();},children:\"Enviar\"})]}),messages]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"info-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flights-info\",children:flights})})]})]});}}]);return App;}(React.Component);ReactDOM.render(/*#__PURE__*/_jsx(App,{}),document.getElementById('root'));","map":{"version":3,"sources":["/Users/matiaszenteno/app/src/index.js"],"names":["React","ReactDOM","io","Leaflet","MapContainer","TileLayer","Marker","Popup","Polyline","Icon","Default","prototype","_getIconUrl","mergeOptions","className","App","props","setCurrentNickname","nickname","setState","current_nickname","setNickname","state","setCurrentMessage","message","current_message","sendMessage","body","name","socket","emit","messages","flights","positions","paths","bind","connect","path","transports","on","position","prevState","code","map","index","flight","passenger","key","age","Object","keys","e","target","value","Component","render","document","getElementById"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport io from \"socket.io-client\";\n\nimport './index.css';\n\nimport Leaflet from 'leaflet';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline } from 'react-leaflet';\n\ndelete Leaflet.Icon.Default.prototype._getIconUrl;\n\nLeaflet.Icon.Default.mergeOptions({\n  className: 'icon',\n});\n\nclass App extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      nickname: '',\n      current_nickname: '',\n      current_message: '',\n      messages: [],\n      flights: [],\n      positions: {},\n      paths: {},\n    }\n    this.setCurrentNickname = this.setCurrentNickname.bind(this);\n    this.setNickname = this.setNickname.bind(this);\n    this.setCurrentMessage = this.setCurrentMessage.bind(this);\n  }\n\n  componentDidMount () {\n    this.socket = io.connect('wss://tarea-3-websocket.2021-1.tallerdeintegracion.cl', {\n      path: '/flights/',\n      transports: ['websocket'],\n    });\n\n    this.socket.on('CHAT', message => {\n      this.setState({ messages: [...this.state.messages, message]})\n    });\n\n    this.socket.on('FLIGHTS', flights => {\n      this.setState({ flights: flights})\n    });\n\n    this.socket.on('POSITION', position => {\n      this.setState(prevState => ({\n        positions: {\n            ...prevState.positions,\n            [position.code]: position.position,\n        },\n      }));\n      this.socket.emit('FLIGHTS', {})\n    });\n  }\n\n  setCurrentNickname = nickname => {\n    this.setState({ current_nickname: nickname})\n  }\n\n  setNickname = () => {\n    this.setState({ nickname: this.state.current_nickname})\n  }\n\n  setCurrentMessage = message => {\n    this.setState({ current_message: message})\n  }\n\n  sendMessage = () => {\n    if (this.state.nickname) {\n      const body = this.state.current_message\n      const message = {\n        name: this.state.nickname,\n        message: body\n      }\n      this.socket.emit('CHAT', message)\n    }\n  }\n\n  render() {\n    const messages = this.state.messages.map((message, index) => {\n      return <li key={index}>\n        <b>{message.name}: {message.message}</b>\n      </li>\n    });\n\n    const flights = this.state.flights.map((flight, index) => {\n      return <li key={index}>\n        <div className=\"flight-info\">\n          <p className=\"flight-info-line\"><b>VUELO {flight['code']}</b></p>\n          <p className=\"flight-info-line\"><b>Aerolínea:</b> {flight['airline']}</p>\n          <p className=\"flight-info-line\"><b>Origen:</b> {flight['origin']}</p>\n          <p className=\"flight-info-line\"><b>Destino:</b> {flight['destination']}</p>\n          <p className=\"flight-info-line\"><b>Avión:</b> {flight['plane']}</p>\n          <p className=\"flight-info-line\"><b>Asientos:</b> {flight['seats']}</p>\n          <p className=\"flight-info-line\"><b>Pasajeros:</b></p>\n          {flight['passengers'].map((passenger, key) => (\n            <p key={key}>\n              {passenger.name}, {passenger.age} años.\n            </p>\n          ))}\n        </div>     \n      </li>\n    });\n\n    return(\n      <div>\n        <div className=\"title-container\">\n          <h1>Información Vuelos</h1>\n        </div>\n        <div className=\"general-container\">\n          <div className=\"base-container\">\n            <div className=\"map-container\">\n              <div>\n                <MapContainer className=\"map\" zoom={5} center={[-30, -70]} >\n                  <TileLayer\n                    attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n                    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                  />\n                  {Object.keys(this.state.positions).map((key, index) => (\n                    <Marker key={key} position={this.state.positions[key]}>\n                      <Popup>{key}</Popup>\n                    </Marker>\n                  ))}\n                </MapContainer>\n              </div>\n            </div>\n\n            <div className=\"chat-container\">\n              <h2>Centro de Control</h2>\n\n              <div className=\"nickname-container\">\n                <input\n                  type=\"text\"\n                  placeholder='Ingresa tu nombre'\n                  onChange={(e) => this.setCurrentNickname(e.target.value)}>\n                </input>\n                <button onClick={() => this.setNickname()}>\n                  Ingresar\n                </button>\n              </div>\n\n              <div className=\"messages-container\">\n                <div className=\"messages-input-container\">\n                  <input\n                    type=\"text\"\n                    placeholder='Ingresa tu mensaje'\n                    onChange={(e) => this.setCurrentMessage(e.target.value)}>\n                  </input>\n                  <button onClick={() => this.sendMessage()}>\n                    Enviar\n                  </button>\n                </div>\n                {messages}\n              </div>\n            </div>\n          </div>\n          <div className=\"info-container\">\n            <div className=\"flights-info\">\n              {flights}\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nReactDOM.render(<App/>, document.getElementById('root'));\n"]},"metadata":{},"sourceType":"module"}